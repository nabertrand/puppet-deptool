#!/usr/bin/env ruby

require 'puppet-deptool'

parser = PuppetDeptool.parser(parse_args: true)
parser.info "Parsed options:\n#{parser.options.pretty_inspect}"
parser.scan
parser.resolve
parser.list_dependencies if parser.options[:list_dependencies]
parser.generate_known_warnings if parser.options[:generate_warnings_file]
parser.generate_state if parser.options[:generate_state_file]
parser.update_metadata if parser.options[:update_metadata]
exit 1 if parser.warnings_encountered && parser.options[:warnings_ok] == false
